<!DOCTYPE html>
<head>
	<link href="/Files/template.css" type="text/css" rel="stylesheet">
	<title>Bigby's Hand Encounter Builder</title>
</head>

<body>
	<div class="banner">
		<img src="/Images/fist.png" alt="Bigby's Hand" class="fist">
	</div>
	
	<div class="body">
		<a href="/Pages/add_monster/add_monster.html"><p>Add a Monster</p></a>
		<a href="/Pages/encounter/encounter.html"><p>Begin Encounter</p></a>
		<p>The encounters total CR is:</p>
		<p id="cr">NA</p><br>
		
		<h3>Monsters</h3>
		<table id="monsterList">
			<tr>
				<th>Name</th>
				<th>Type</th>
				<th>CR</th>
			<tr>
		</table>
		
		<h3>Player Characters</h3>
		<table id="playerList">
			<tr>
				<th>Name</th>
				<th>Level<th>
				<th>Initiative</th>
			</tr>
			<tr>
				<td><input id="playerName" type="text" placeholder="Enter your PC name here"></input></td>
				<td><input id="playerLevel" type="number" placeholder="1"></input></td>
				<td><input id="playerInitiative" type="number" placeholder="10"></input></td>
				<td><button onclick="addPlayer(); return false;">Add Player</td>
			</tr>
		</table>
		
	</div>
	
	<script>
		var monsterList = document.getElementById("monsterList");
		var playerList = document.getElementById("playerList");
		
		var xhttp = new XMLHttpRequest();
		xhttp.open("GET", "/Files/monstermanual.json", false);
		xhttp.send(null);
		var monsterManual = JSON.parse(xhttp.responseText);
		
		var cookie = document.cookie;
		var monsterJSON = cookie.slice(9);
		var myMonsters = JSON.parse(monsterJSON);
		var monsterNumber = myMonsters.length;
		console.log(myMonsters);
		
		function listMonsters(monsterCount) {
			for(var i = 0; i < monsterCount; i++){
				var row = monsterList.insertRow(-1);
				var name = row.insertCell(-1);
				var type = row.insertCell(-1);
				var cr = row.insertCell(-1);
			
				name.innerHTML = monsterManual[myMonsters[i]].name;
				type.innerHTML = monsterManual[myMonsters[i]].type;
				cr.innerHTML = monsterManual[myMonsters[i]].challenge_rating;
			}
		}
		
		function addPlayer(){
			var name = document.getElementById("playerName").value;
			var level = document.getElementById("playerLevel").value;
			var initiative = document.getElementById("playerInitiative").value;
			
			var row = playerList.insertRow(-1);
			var insertName = row.insertCell(-1);
			var insertLevel = row.insertCell(-1);
			var insertInitiative = row.insertCell(-1);
			
			document.getElementById("playerName").value = "";
			document.getElementById("playerLevel").value = "";
			document.getElementById("playerInitiative").value = "";
			
			insertName.innerHTML = name;
			insertLevel.innerHTML = level;
			insertInitiative.innerHTML = initiative;
		}
		
		listMonsters(monsterNumber);
	</script>
</body>
