<!DOCTYPE html>
<head>
	<link href="/Files/template.css" type="text/css" rel="stylesheet">
	<title>Bigby's Hand Encounter Builder</title>

</head>

<body>
	<div class="banner">
		<img src="/Images/fist.png" alt="Bigby's Hand" class="fist">
	</div>
	
	<div class="body">
		<p>You have the following monsters added:</p>
		<p id="current">None</p>
		<form action="" id="filter">
		Filter By
		<select name="filterType" form="filter">
			<option value="cr">CR</option>
			<option value="name">Name</option>
			<option value="type">Type</option>
		</select>
		
		<table id="monsterList">
			<tr>
				<th>Name</th>
				<th>Type</th>
				<th>CR</th>
				<th></th>
			</tr>
		</table>
	</div>
	
	<script>
		var list = document.getElementById("monsterList")
		var myMonsters = new Array();
		
		var xhttp = new XMLHttpRequest();
		xhttp.open("GET", "/Files/monstermanual.json", false);
		xhttp.send(null);
		var monsterManual = JSON.parse(xhttp.responseText);
		
		/*
		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				monsterManual = JSON.parse(this.responseText);
			}
		}
		*/
		console.log(monsterManual);
		
		//var xmlhttp = new XMLHttpRequest();
		//xmlhttp.onreadystatechange = function() {
		//	if (this.readyState == 4 && this.status == 200) {
		//		var monsterManual = JSON.parse(this.responseText);
		//	}
		//};
		//xmlhttp.open("GET", "/Files/monstermanual.json", true);
		//xmlhttp.send();
	
		function listMonsters(monsterCount) {
			for(var i = 0; i < monsterCount; i++){
				var row = list.insertRow(-1);
				var name = row.insertCell(-1);
				var type = row.insertCell(-1);
				var cr = row.insertCell(-1);
				var add = row.insertCell(-1);
			
				name.innerHTML = monsterManual[i].name;
				type.innerHTML = monsterManual[i].type;
				cr.innerHTML = monsterManual[i].challenge_rating;
				add.innerHTML = "<button onClick='addMonster(this.id); return false;' id='" + i + "'>Add</button>";
			}
		}
		
		function addMonster(index){
			myMonsters.push(index);
			
			var current = document.getElementById("current").innerHTML;
			var number = myMonsters.length;
			for (var i = 0; i < number; i++){
				current = current + monsterManual[myMonsters[i]] + " ";
			}
			
			overwriteCookie();
		}
		
		function overwriteCookie(){
		
		}
		
		listMonsters(monsterManual.length);
	</script>
</body>
