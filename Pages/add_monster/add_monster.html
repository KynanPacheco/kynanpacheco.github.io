<!DOCTYPE html>
<head>
	<link href="/Files/template.css" type="text/css" rel="stylesheet">
	<title>Bigby's Hand Encounter Builder</title>

</head>

<body>
	<div class="banner">
		<a href="/index.html"><img src="/Images/fist.png" alt="Bigby's Hand" class="fist"></a>
	</div>
	
	<div class="body">
		<form action="" id="filter">
		Filter By
		<select name="filterType" form="filter">
			<option value="cr">CR</option>
			<option value="name">Name</option>
			<option value="type">Type</option>
		</select>
		
		<table id="monsterList">
			<tr>
				<th>Name</th>
				<th>Type</th>
				<th>CR</th>
				<th></th>
			</tr>
		</table>
	</div>
	
	<script>
		var list = document.getElementById("monsterList")
		var myMonsters = new Array();
		
		var xhttp = new XMLHttpRequest();
		xhttp.open("GET", "/Files/monstermanual.json", false);
		xhttp.send(null);
		var monsterManual = JSON.parse(xhttp.responseText);
	
		function listMonsters(monsterCount) {
			for(var i = 0; i < monsterCount; i++){
				var row = list.insertRow(-1);
				var name = row.insertCell(-1);
				var type = row.insertCell(-1);
				var cr = row.insertCell(-1);
				var add = row.insertCell(-1);
				var number = row.insertCell(-1);
			
				name.innerHTML = monsterManual[i].name;
				type.innerHTML = monsterManual[i].type;
				cr.innerHTML = monsterManual[i].challenge_rating;
				add.innerHTML = "<button onClick='addMonster(this.id); return false;' id='" + i + "'>Add</button>";
				number.innerHTML = "<p id='" + i + "count'>0</p>";
			}
		}
		
		function addMonster(index){
			myMonsters.push(index);
			
			var count = Number(document.getElementById(index + "count").innerHTML);
			count++
			document.getElementById(index + "count").innerHTML = count;
			
			setCookie(myMonsters, 1);
		}
		
		function setCookie(cvalue, exdays) {
			var jsonVal = JSON.stringify(cvalue);
			var d = new Date();
			d.setTime(d.getTime() + (exdays*24*60*60*1000));
			var expires = "expires="+ d.toUTCString();
			document.cookie = "monsters =" + jsonVal + ";" + expires + ";path=/";
			
			var cookie = document.cookie;
			console.log(cookie);
		}
		
		listMonsters(monsterManual.length);
	</script>
</body>
